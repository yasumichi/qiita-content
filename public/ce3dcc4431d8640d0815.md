---
title: SeaPig で uiflow サポートを追加してみた
tags:
  - Markdown
  - Electron
  - uiflow
private: false
updated_at: '2016-08-16T18:38:54+09:00'
id: ce3dcc4431d8640d0815
organization_url_name: null
slide: false
ignorePublish: false
---
![](https://raw.githubusercontent.com/yasumichi/seapig/master/seapig.png) [SeaPig](https://github.com/yasumichi/seapig) is converter from markdown to html with marked.js and highlight.js.

[SeaPig v0.3.0](https://github.com/yasumichi/seapig/releases/tag/v0.3.0) で viz.js サポートは実装済みで dot 記法から、グラフ画像を埋め込めるようにはしていたのですが、[SeaPig v0.5.0](https://github.com/yasumichi/seapig/releases/tag/v0.5.0) では、[uiflow](https://github.com/hirokidaichi/uiflow)を内蔵し、[uiflow の記法にも対応しました](http://qiita.com/yasumichi/items/b3acec72d740fba4b7f7#uiflow-%E3%82%B5%E3%83%9D%E3%83%BC%E3%83%88v050%E3%81%AB%E3%81%A6)。実装の際に困ったことを記録として残しておきます。

## 筆者の環境

- [VineSeed](https://vinelinux.org/vineseed.html) ([Vine Linux](https://vinelinux.org/) 開発版) 64bit
- [nodebrew](https://github.com/hokaccha/nodebrew) use v4.4.7(LTS)

## uiflow 使用に際し、困ったこと

[uiflowをライブラリとして使う](https://github.com/hirokidaichi/uiflow#uiflow%E3%82%92%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%81%A8%E3%81%97%E3%81%A6%E4%BD%BF%E3%81%86)を参考に実装前に node インタープリタで試してみたのですが、筆者の環境では以下のエラーが出てうまく行きませんでした。

```
$ node
> var uiflow = require("uiflow");
undefined
> uiflow.compile("[テスト]\nユーザーが見るもの\nユーザがすること\n");
ReferenceError: d is not defined
    at Object.uiflow.compile (/home/yasumichi/other/guiflow/node_modules/uiflow/index.js:112:37)
    at repl:1:8
    at REPLServer.defaultEval (repl.js:262:27)
    at bound (domain.js:287:14)
    at REPLServer.runBound [as eval] (domain.js:300:12)
    at REPLServer.<anonymous> (repl.js:431:12)
    at emitOne (events.js:82:20)
    at REPLServer.emit (events.js:169:7)
    at REPLServer.Interface._onLine (readline.js:211:10)
    at REPLServer.Interface._line (readline.js:550:8)
```

原因を調査している過程で @tkrkt さんの[ローカル画像生成サーバ作ってMarkdown記事執筆を加速する - Qiita](http://qiita.com/tkrkt/items/f65a4be0cd57235217c9)という記事に出会い、その途中に以下の記述を見つけました。

> ※uiflowでエラー出るならこっちで。
> 
> `$ npm install uiflow@git+https://github.com/tkrkt/uiflow.git#fix-argument-in-compile`

という訳で @tkrkt さんの修正版をインストールして同様の実験を行なったところ、問題なく動作しました。(参考:修正版の[差分](https://github.com/tkrkt/uiflow/commit/3e5037967394028351873e3db0533932509f751a))

## 参考リンク

- [もう保守されない画面遷移図は嫌なので、UI Flow図を簡単にマークダウンぽく書くエディタ作った - Qiita](http://qiita.com/hirokidaichi/items/ff54a968bdd7bcc50d42)
- [ローカル画像生成サーバ作ってMarkdown記事執筆を加速する - Qiita](http://qiita.com/tkrkt/items/f65a4be0cd57235217c9)
- [uiflowのvscodeプラグインを作ってみました - Qiita](http://qiita.com/kexi/items/f5bd25fd4a7da81e62d4)
- [innerText(textContent)/innerHTMLを使わずJavaScriptでHTMLエスケープ - Qiita](http://qiita.com/noriaki/items/4bfef8d7cf85dc1035b3)
- [uiflow](https://github.com/hirokidaichi/uiflow)
- [uiflow @tkrkt さん修正版](https://github.com/tkrkt/uiflow/tree/fix-argument-in-compile)(fix argument in compile)
